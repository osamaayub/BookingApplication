(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[7],{301:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return j})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return h}));var a=n(23),r=n(36),c=n(305),i=n(311),o=n.n(i),s=n(62),l=n(312),u=n(313),d=Object(l.a)({apiKey:"AIzaSyA3VHRbj4knFBXK3YVFdsr7xn2MvE1A0_E",authDomain:"hotel-booking-app-2c070.firebaseapp.com",projectId:"hotel-booking-app-2c070",storageBucket:"hotel-booking-app-2c070.appspot.com",messagingSenderId:"308536271440",appId:"1:308536271440:web:cf389c892a5fa653486755"}),b=Object(u.a)(d),p=n(349),m=function(e){return o()(e).format("DD/MM/YYYY")},j=function(e){return o()(e).format("Do MMMM, YYYY")},f=function(e){var t=o()(),n=o()(e).format("YYYY");return t.diff(n,"years")},g=function(){var e=Object(r.a)(Object(a.a)().mark((function e(t,n){var i,o,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return alert("No file found."),e.abrupt("return");case 3:return i=Object(c.d)(b,n),(o=Object(c.e)(i,t)).on("state_changed",(function(e){}),(function(e){s.b.error(e,{autoClose:5500,pauseOnHover:!0})}),(function(){l=Object(c.b)(o.snapshot.ref)})),e.next=8,Promise.resolve(o).then(function(){var e=Object(r.a)(Object(a.a)().mark((function e(t){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve(l).then((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(r.a)(Object(a.a)().mark((function e(t,n){var c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!==t.length){e.next=3;break}return alert("No file found."),e.abrupt("return");case 3:return c=[],e.next=6,Promise.all(t.map(function(){var e=Object(r.a)(Object(a.a)().mark((function e(t,r){var i,o,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(p.a)(),o="images/rooms/".concat(n.id,"/roomImage-").concat(i),e.next=4,g(t,o);case 4:s=e.sent,c.push({url:s,uuid:i});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(r.a)(Object(a.a)().mark((function e(t,n){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Object(r.a)(Object(a.a)().mark((function e(t,r){var i,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.uuid,o=Object(c.d)(b,"images/rooms/".concat(n,"/roomImage-").concat(i)),e.next=4,Object(c.a)(o);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},302:function(e,t,n){"use strict";n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return j})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return O}));var a,r,c,i,o,s,l,u=n(12),d=n(18),b=d.a.div(a||(a=Object(u.a)(["\n    position: fixed;\n    top: 0;\n    right: 0;\n    left: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background: #000000d1;\n    z-index: 9999999\n"]))),p=d.a.div(r||(r=Object(u.a)([";\n    width: 700px;\n    max-height: 80vh;\n    overflow-y: scroll;\n    background: #fff;\n    padding: 20px;\n    border-radius: 6px;\n    position: relative;\n    .close-icon{\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        cursor: pointer\n    }\n    @media(max-width: 700px){\n        width: calc(100vw - 40px);\n    }\n"]))),m=d.a.h3(c||(c=Object(u.a)(["\n    font-weight: 26px;\n    font-weight: 600;\n    margin-bottom: 20px\n"]))),j=d.a.div(i||(i=Object(u.a)(["\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));\n    justify-content: center;\n    row-gap: 16px;\n    column-gap: 16px;\n    div{\n        width: 40px;\n        height: 40px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border: 1px solid red;\n        cursor: pointer;\n        border-radius: 4px;\n    }\n    .assigned{\n        background: #ffadad\n    }\n    .selected{\n        background: #8dffd0;\n        border-color: green\n    }\n"]))),f=d.a.div(o||(o=Object(u.a)(["\n    margin-bottom: 20px;\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    grid-gap: 16px;\n"]))),g=d.a.div(s||(s=Object(u.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    border-radius: 4px;\n    background: #ffcdb8;\n    height: 160px;\n    .plus-icon{\n        color: #9a9a9a !important;\n        font-size: 40px !important;\n    }\n"]))),O=d.a.div(l||(l=Object(u.a)(["\n    display: flex;\n    justify-content: space-between\n"])))},303:function(e,t,n){},314:function(e,t,n){"use strict";var a,r,c=n(30),i=n(17),o=n(12),s=n(0),l=n(32),u=n(18),d=n(323),b=n.n(d),p=(n(326),n(302)),m=n(72),j=n(75),f=n(327),g=n.n(f),O=n(1),h=u.a.div(a||(a=Object(o.a)(["\n    margin-bottom: 20px;\n    background: #e2e2e2;\n    border-radius: 4px;\n    overflow: hidden;\n"]))),x=u.a.div(r||(r=Object(o.a)(["\n    overflow: hidden;\n    cursor: pointer;\n    height: 260px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    &.selected{\n        border: 2px red solid\n    }\n    img{\n        max-width: 100%;\n        max-height: 100%;\n    }\n    .delete-icon{\n        position: absolute;\n        bottom: 2px;\n        right: 2px;\n        background: white;\n        padding: 2px;\n        border-radius: 4px\n    }\n"])));t.a=function(e){var t=e.setImageURL,n=e.imageUrl,a=e.data,r=e.styles,o=e.setSelected,u=e.selected,d=Object(s.useRef)(null),f=Object(s.useState)(n||j.a),v=Object(i.a)(f,2),y=v[0],w=v[1],k=Object(s.useState)(!1),C=Object(i.a)(k,2),S=C[0],H=C[1],R=Object(s.useState)(null),$=Object(i.a)(R,2),I=$[0],M=$[1],N=Object(s.useState)({unit:"px",x:130,y:50,width:160,height:90,aspect:16/9}),U=Object(i.a)(N,2),Y=U[0],D=U[1],L=Object(s.useState)(""),A=Object(i.a)(L,2),B=A[0],P=A[1],J=Object(s.useState)({}),E=Object(i.a)(J,2),F=(E[0],E[1]);function q(e){e.preventDefault();var n=document.createElement("canvas"),a=I.naturalWidth/I.width,r=I.naturalHeight/I.height;n.width=Y.width,n.height=Y.height,n.getContext("2d").drawImage(I,Y.x*a,Y.y*r,Y.width*a,Y.height*r,0,0,Y.width,Y.height);var c=n.toDataURL("image/jpeg"),i=function(e,t){for(var n=e.split(","),a=n[0].match(/:(.*?);/)[1],r=atob(n[1]),c=r.length,i=new Uint8Array(c);c--;)i[c]=r.charCodeAt(c);return new File([i],t,{type:a})}(c,"file.jpg");P(c),t(i),H(!1)}return Object(O.jsxs)(h,{children:[S&&Object(O.jsx)(p.e,{children:Object(O.jsx)(p.d,{children:y&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(b.a,{src:y,onImageLoaded:M,crop:Y,onChange:D}),Object(O.jsxs)(m.b,{children:[Object(O.jsx)(l.a,{className:"crop-btn",onClick:function(){return w(n),void H(!1)},children:"Cancel"}),Object(O.jsx)(l.a,{className:"crop-btn",onClick:function(e){return q(e)},children:"Crop & Upload Image"})]})]})})}),e.single?Object(O.jsx)(x,{onClick:function(){return n?null:d.current.click()},style:r,children:B?Object(O.jsx)("img",{src:B,alt:""}):Object(O.jsx)("img",{src:y,alt:""})}):Object(O.jsxs)(x,{onClick:function(){return n?null:d.current.click()},style:r,className:"".concat(u.includes(a.uuid)?"selected":""),children:[B?Object(O.jsx)("img",{src:B,alt:""}):Object(O.jsx)("img",{src:y,alt:""}),n&&Object(O.jsx)(g.a,{className:"delete-icon",onClick:function(){if(u.includes(a.uuid)){var e=u.filter((function(e){return e!==a.uuid}));o(e)}else o([].concat(Object(c.a)(u),[a.uuid]))}})]}),Object(O.jsx)(l.c,{type:"file",accept:"image/*",onChange:function(e){return function(e){e.preventDefault(),F(e.target.files[0]),w(URL.createObjectURL(e.target.files[0])),H(!0)}(e)},style:{display:"none"},ref:d})]})}},321:function(e,t,n){"use strict";var a,r,c=n(27),i=n(23),o=n(36),s=n(17),l=n(292),u=n(0),d=n(32),b=n(302),p=n(62),m=(n(156),n(304)),j=n.n(m),f=(n(303),n(107)),g=n(12),O=n(60),h=Object(O.a)(a||(a=Object(g.a)(["\nmutation($image: String, $name: String!, $description: String!, $totalRooms: Int!, $location: String!, $manager: ID!){\n    addHotel(manager: $manager, image: $image, name: $name, description: $description, totalRooms: $totalRooms, location: $location){\n      id\n      name\n      description\n    }\n  }\n"]))),x=Object(O.a)(r||(r=Object(g.a)(["\nmutation($id: ID!, $image: String, $name: String!, $description: String!, $ratings: Int, $totalRooms: Int!, $location: String!){\n    updateHotel(id: $id, image: $image, name: $name, description: $description, ratings: $ratings, totalRooms: $totalRooms, location: $location){\n      id\n      name\n    }\n  }\n"]))),v=n(314),y=n(301),w=n(106),k=n(108),C=n(1);t.a=function(e){var t,n=e.hotel,a=JSON.parse(localStorage.getItem("user")),r=Object(u.useState)(!1),m=Object(s.a)(r,2),g=m[0],O=m[1],S=Object(u.useState)(!1),H=Object(s.a)(S,2),R=H[0],$=H[1],I=Object(u.useState)({name:n?n.name:"",description:n?n.description:"",id:e.hotel?e.hotel.id:null,image:n?n.image:"",ratings:n?n.ratings:null,totalRooms:n?n.totalRooms:null,location:n?n.location:""}),M=Object(s.a)(I,2),N=M[0],U=M[1],Y=Object(l.a)(k.b,{variables:{id:a.id}}),D=Object(s.a)(Y,1)[0],L=Object(l.a)(h),A=Object(s.a)(L,1)[0],B=Object(l.a)(x,{refetchQueries:[f.a,{variables:{id:null===(t=e.hotel)||void 0===t?void 0:t.id}}]}),P=Object(s.a)(B,1)[0],J=function(){var t=Object(o.a)(Object(i.a)().mark((function t(a){var r,c,o;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),$(!0),!((r=Object.keys(n.roomsMap).length)>N.totalRooms)){t.next=6;break}return p.b.warning("You have already assigned ".concat(r," rooms. Unassign those rooms to decrease room numbers."),{autoClose:5500,pauseOnHover:!0}),t.abrupt("return");case 6:if(c="images/hotels/".concat(N.id,"/hotelImage"),o=null,"string"===typeof N.image){t.next=12;break}return t.next=11,Object(y.f)(N.image,c);case 11:o=t.sent;case 12:P({variables:{name:N.name,description:N.description,id:N.id,image:o||N.image,ratings:N.ratings,totalRooms:N.totalRooms,location:N.location}}).then((function(t){p.b.success("Updated hotel.",{autoClose:5500,pauseOnHover:!0,onClose:e.setHotelModal(!1)}),O(!0),$(!1)})).catch((function(e){p.b.error(e.message,{autoClose:5500,pauseOnHover:!0}),$(!1)}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),$(!0),A({variables:{manager:a.id,image:null,name:N.name,description:N.description,totalRooms:N.totalRooms,location:N.location}}).then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){var r,c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="images/hotels/".concat(n.data.addHotel.id,"/hotelImage"),c=null,"string"===typeof N.image){t.next=6;break}return t.next=5,Object(y.f)(N.image,r);case 5:c=t.sent;case 6:P({variables:{name:N.name,description:N.description,id:n.data.addHotel.id,image:c,ratings:n.data.addHotel.ratings,totalRooms:N.totalRooms,location:N.location}}).then((function(t){p.b.success("Hotel added.",{autoClose:5500,pauseOnHover:!0}),D({variables:{id:a.id}}).then((function(t){localStorage.setItem("user",JSON.stringify(t.data.makeManager)),O(!0),$(!1),e.setHotelModal(!1)})).catch((function(e){p.b.error(e.message,{autoClose:5500,pauseOnHover:!0}),$(!1)}))})).catch((function(e){p.b.error(e.message,{autoClose:5500,pauseOnHover:!0}),$(!1)}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){p.b.error(e.message,{autoClose:5500,pauseOnHover:!0}),$(!0)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(C.jsx)(b.e,{children:Object(C.jsx)(b.d,{className:"modal-box",children:R?Object(C.jsx)(w.a,{}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(j.a,{className:"close-icon",onClick:function(){return e.setHotelModal(!1)}}),Object(C.jsx)(b.f,{children:e.title}),Object(C.jsx)(v.a,{imageUrl:N.image,refPath:"images/hotels/".concat(N.id,"/hotelImage"),setImageURL:function(e){return U(Object(c.a)(Object(c.a)({},N),{},{image:e}))},single:!0}),Object(C.jsxs)("form",{onSubmit:"update"===e.action?J:E,children:[Object(C.jsx)(d.c,{required:"true",style:{marginBottom:"16px"},value:N.name,onChange:function(e){return U(Object(c.a)(Object(c.a)({},N),{},{name:e.target.value}))},placeholder:"Hotel name"}),Object(C.jsx)(d.e,{required:"true",style:{marginBottom:"16px"},value:N.description,onChange:function(e){return U(Object(c.a)(Object(c.a)({},N),{},{description:e.target.value}))},placeholder:"Hotel description"}),Object(C.jsx)(d.c,{required:"true",style:{marginBottom:"16px"},value:N.location,onChange:function(e){return U(Object(c.a)(Object(c.a)({},N),{},{location:e.target.value}))},placeholder:"Location"}),Object(C.jsx)(d.c,{required:"true",style:{marginBottom:"16px"},value:N.totalRooms,onChange:function(e){return U(Object(c.a)(Object(c.a)({},N),{},{totalRooms:Number(e.target.value)}))},placeholder:"Total Rooms"}),!g&&Object(C.jsx)(d.a,{type:"submit",style:{marginLeft:"auto",marginTop:"40px"},children:e.title})]})]})})})}},346:function(e,t,n){"use strict";n.r(t);var a,r,c=n(27),i=n(17),o=n(12),s=n(0),l=n(20),u=n(43),d=n(18),b=n(32),p=n(301),m=n(97),j=n.n(m),f=(n(159),n(321)),g=n(292),O=n(110),h=n(108),x=n(62),v=n(1),y=d.a.div(a||(a=Object(o.a)(["\n    margin-bottom: 16px;\n    width: 100%;\n    &.flex{\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        .first{\n            margin-right: 16px\n        }\n    }\n    label{\n        display: block;\n        margin-bottom: 10px\n    }\n"]))),w=d.a.div(r||(r=Object(o.a)(["\n    position: absolute;\n    top: -20px;\n    right: -30px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 12px;\n    background: #4158ff;\n    width: 30px;\n    height: 30px;\n    border-radius: 50%;\n    color: #fff;\n"])));t.default=function(){var e=Object(s.useContext)(u.a).setPage,t=JSON.parse(localStorage.getItem("user")),n=Object(s.useState)({state:!1,title:"",param:null,action:""}),a=Object(i.a)(n,2),r=a[0],o=a[1],d=Object(s.useState)(!1),m=Object(i.a)(d,2),k=m[0],C=m[1],S=Object(s.useState)(t),H=Object(i.a)(S,2),R=H[0],$=H[1];Object(s.useEffect)((function(){e("Profile")}),[]);var I=Object(g.a)(h.d,{refetchQueries:[O.a,{variables:{id:t.id}}]}),M=Object(i.a)(I,1)[0];Object(s.useEffect)((function(){R.name!==t.name||R.email!==t.email||R.dob!==t.dob?C(!0):C(!1)}),[R]);return Object(v.jsxs)(l.c,{style:{maxWidth:"800px",marginLeft:"auto",marginRight:"auto"},children:[r.state&&Object(v.jsx)(f.a,{action:r.action,title:r.title,hotel:null,setHotelModal:o}),Object(v.jsxs)(l.g,{style:{position:"relative",width:"fit-content"},children:["Hello ",t.name,t.isManager&&Object(v.jsx)(w,{children:"M"})]}),Object(v.jsxs)(l.g,{className:"small",style:{marginBottom:"8px"},children:["Joined on ",Object(p.e)(t.joined)]}),Object(v.jsxs)(l.g,{className:"small",children:["Type: ",t.isManager?"Hotel Manager":t.isAdmin?"Admin":"User"]}),t.isManager?null:Object(v.jsx)(b.a,{style:{margin:"16px 0",borderRadius:"2px"},onClick:function(){return o({state:!0,title:"Add Hotel",params:null,action:"add"})},children:"Add My Hotel"}),Object(v.jsxs)(y,{className:"flex",children:[Object(v.jsxs)(y,{className:"first",children:[Object(v.jsx)("label",{children:"Name"}),Object(v.jsx)(b.c,{value:R.name,onChange:function(e){return $(Object(c.a)(Object(c.a)({},R),{},{name:e.target.value}))}})]}),Object(v.jsxs)(y,{children:[Object(v.jsx)("label",{children:"Username"}),Object(v.jsx)(b.c,{value:t.username})]})]}),Object(v.jsxs)(y,{className:"flex",children:[Object(v.jsxs)(y,{className:"first",children:[Object(v.jsx)("label",{children:"E-Mail"}),Object(v.jsx)(b.c,{value:R.email,onChange:function(e){return $(Object(c.a)(Object(c.a)({},R),{},{email:e.target.value}))}})]}),Object(v.jsxs)(y,{children:[Object(v.jsx)("label",{children:"DOB"}),Object(v.jsx)(j.a,{selected:new Date(R.dob),onChange:function(e){return $(Object(c.a)(Object(c.a)({},R),{},{dob:e}))}})]})]}),k?Object(v.jsx)(b.a,{style:{marginLeft:"auto"},onClick:function(){M({variables:{id:"",name:R.name,email:R.email,dob:R.dob,username:R.username}}).then((function(e){C(!1),localStorage.setItem("user",JSON.stringify(e.data.updateProfile)),x.b.success("User details updated.",{autoClose:5500,pauseOnHover:!0})})).catch((function(e){C(!1),x.b.error(e.message,{autoClose:5500,pauseOnHover:!0}),$(t)}))},children:"Update & Save"}):null]})}}}]);
//# sourceMappingURL=7.65de1def.chunk.js.map